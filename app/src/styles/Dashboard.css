@import "tailwindcss";
@import "./theme.css";

@layer components {
  .dashboard-container {
    @apply h-full flex flex-col space-y-8 max-w-7xl mx-auto pb-8;
  }

  .dashboard-header {
    @apply flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4;
  }

  .dashboard-title {
    @apply text-3xl font-bold text-slate-900 dark:text-slate-100 tracking-tight;
  }

  .dashboard-subtitle {
    @apply text-slate-500 dark:text-slate-400 font-medium mt-1;
  }

  .time-range-selector {
    @apply bg-white dark:bg-slate-800 p-1.5 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex;
  }

  .time-range-button {
    @apply px-2 sm:px-4 py-1.5 text-xs font-bold rounded-lg transition-all duration-200;
  }

  .time-range-button-active {
    @apply bg-slate-900 dark:bg-brand-600 text-white shadow-md;
  }

  .time-range-button-inactive {
    @apply text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700;
  }

  .summary-cards-grid {
    @apply grid grid-cols-1 sm:grid-cols-3 gap-6;
  }

  .summary-card {
    @apply bg-gradient-to-br from-white to-slate-50 dark:from-slate-800 dark:to-slate-800/50 p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700 flex flex-col justify-center transition-all duration-300;
  }

  .summary-card-title {
    @apply text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-3 group-hover:text-brand-600 dark:group-hover:text-brand-400 transition-colors;
  }

  .summary-card-value {
    @apply text-3xl font-bold text-slate-900 dark:text-slate-100 tracking-tight;
  }

  .chart-container {
    @apply flex flex-col flex-1 bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700 min-h-[400px] hover:shadow-lg transition-shadow duration-300 overflow-hidden;
  }

  .chart-header {
    @apply mb-6;
  }

  .chart-title {
    @apply text-lg font-bold text-slate-900 dark:text-slate-100;
  }

  .chart-subtitle {
    @apply text-sm text-slate-500 dark:text-slate-400 mt-1;
  }

  .chart-wrapper {
    @apply h-[350px] min-h-0 flex flex-col overflow-hidden relative;
  }

  .chart-body {
    @apply flex-1 min-h-0 overflow-hidden relative;
  }

  /* Ensure direct children (Chart.js containers/canvas) fit their parent */
  .chart-body > * {
    width: 100%;
    height: 100%;
  }

  /* 
   * Removed aggressive !important overrides on canvas that were breaking resize behavior.
   * Chart.js with maintainAspectRatio: false handles sizing relative to the parent container (.chart-body).
   */

  .loading-container {
    @apply h-full flex items-center justify-center;
  }

  .loading-content {
    @apply flex flex-col items-center gap-3;
  }

  .loading-spinner {
    @apply w-12 h-12 border-4 border-brand-200 border-t-brand-600 rounded-full animate-spin;
  }

  .loading-text {
    @apply text-slate-400 font-medium;
  }

  .charts-grid {
    @apply grid grid-cols-1 lg:grid-cols-2 gap-6;
  }

  .chart-card {
    @apply bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700 h-[400px] hover:shadow-lg transition-shadow duration-300 flex flex-col overflow-hidden;
  }

  .chart-body canvas {
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    display: block;
    box-sizing: border-box;
  }

  .chart-card-full {
    @apply lg:col-span-2;
  }

  /* Transaction table scales with font-size, including padding for horizontal fit */
  .account-transactions-table {
    /* Font size scales with global setting - much smaller base size (12px) for very compact table */
    font-size: calc(12px * var(--hb-font-size));
  }

  .account-transactions-table thead th {
    /* Padding scales with font size - em units are relative to table font-size */
    /* To allow more horizontal content when font is smaller, we reduce padding more aggressively */
    padding: calc(0.75em * var(--hb-font-size) * var(--hb-font-size))
      calc(1em * var(--hb-font-size) * var(--hb-font-size)) !important;
    font-size: inherit !important;
  }

  .account-transactions-table tbody td {
    /* Padding scales with font size - em units are relative to table font-size */
    /* To allow more horizontal content when font is smaller, we reduce padding more aggressively */
    padding: calc(0.75em * var(--hb-font-size) * var(--hb-font-size))
      calc(1em * var(--hb-font-size) * var(--hb-font-size)) !important;
    font-size: inherit !important;
  }

  /* Inputs and controls inside table scale with font size */
  .account-transactions-table input,
  .account-transactions-table .rounded-lg,
  .account-transactions-table .p-2 {
    padding: calc(0.25em * var(--hb-font-size)) !important;
    font-size: inherit !important;
  }

  /* Header and Form above transaction table also scale with font-size */
  .account-details-scaled-container .text-3xl,
  .dashboard-container .text-3xl,
  .investment-dashboard-container .text-3xl,
  .rules-container .text-3xl,
  .dashboard-title,
  .summary-card-value {
    font-size: calc(1.875rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-2xl,
  .dashboard-container .text-2xl,
  .investment-dashboard-container .text-2xl,
  .rules-container .text-2xl {
    font-size: calc(1.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-xl,
  .dashboard-container .text-xl,
  .investment-dashboard-container .text-xl,
  .rules-container .text-xl {
    font-size: calc(1.25rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-lg,
  .dashboard-container .text-lg,
  .investment-dashboard-container .text-lg,
  .rules-container .text-lg,
  .chart-title {
    font-size: calc(1.125rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-base,
  .dashboard-container .text-base,
  .investment-dashboard-container .text-base,
  .rules-container .text-base {
    font-size: calc(1rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-sm,
  .dashboard-container .text-sm,
  .investment-dashboard-container .text-sm,
  .rules-container .text-sm,
  .chart-subtitle,
  .dashboard-subtitle {
    font-size: calc(0.875rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .text-xs,
  .dashboard-container .text-xs,
  .investment-dashboard-container .text-xs,
  .rules-container .text-xs,
  .summary-card-title,
  .time-range-button {
    font-size: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .py-4,
  .dashboard-container .py-4,
  .investment-dashboard-container .py-4,
  .rules-container .py-4 {
    padding-top: calc(1rem * var(--hb-font-size)) !important;
    padding-bottom: calc(1rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .py-3,
  .dashboard-container .py-3,
  .investment-dashboard-container .py-3,
  .rules-container .py-3 {
    padding-top: calc(0.75rem * var(--hb-font-size)) !important;
    padding-bottom: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .py-2,
  .dashboard-container .py-2,
  .investment-dashboard-container .py-2,
  .rules-container .py-2 {
    padding-top: calc(0.5rem * var(--hb-font-size)) !important;
    padding-bottom: calc(0.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .py-1\.5,
  .dashboard-container .py-1\.5,
  .investment-dashboard-container .py-1\.5,
  .rules-container .py-1\.5 {
    padding-top: calc(0.375rem * var(--hb-font-size)) !important;
    padding-bottom: calc(0.375rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .p-1\.5,
  .dashboard-container .p-1\.5,
  .investment-dashboard-container .p-1\.5,
  .rules-container .p-1\.5,
  .time-range-selector {
    padding: calc(0.375rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .p-1,
  .dashboard-container .p-1,
  .investment-dashboard-container .p-1,
  .rules-container .p-1 {
    padding: calc(0.25rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .px-6,
  .dashboard-container .px-6,
  .investment-dashboard-container .px-6,
  .rules-container .px-6 {
    padding-left: calc(1.5rem * var(--hb-font-size)) !important;
    padding-right: calc(1.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .p-6,
  .dashboard-container .p-6,
  .investment-dashboard-container .p-6,
  .rules-container .p-6,
  .summary-card,
  .chart-container,
  .chart-card {
    padding: calc(1.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .px-5,
  .dashboard-container .px-5,
  .investment-dashboard-container .px-5,
  .rules-container .px-5 {
    padding-left: calc(1.25rem * var(--hb-font-size)) !important;
    padding-right: calc(1.25rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .px-4,
  .dashboard-container .px-4,
  .investment-dashboard-container .px-4,
  .rules-container .px-4 {
    padding-left: calc(1rem * var(--hb-font-size)) !important;
    padding-right: calc(1rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .px-3,
  .dashboard-container .px-3,
  .investment-dashboard-container .px-3,
  .rules-container .px-3 {
    padding-left: calc(0.75rem * var(--hb-font-size)) !important;
    padding-right: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .px-2,
  .dashboard-container .px-2,
  .investment-dashboard-container .px-2,
  .rules-container .px-2 {
    padding-left: calc(0.5rem * var(--hb-font-size)) !important;
    padding-right: calc(0.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .pr-10,
  .dashboard-container .pr-10,
  .investment-dashboard-container .pr-10,
  .rules-container .pr-10 {
    padding-right: calc(2.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .p-3,
  .dashboard-container .p-3,
  .investment-dashboard-container .p-3,
  .rules-container .p-3 {
    padding: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .p-2\.5,
  .dashboard-container .p-2\.5,
  .investment-dashboard-container .p-2\.5,
  .rules-container .p-2\.5 {
    padding: calc(0.625rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .w-5,
  .dashboard-container .w-5,
  .investment-dashboard-container .w-5,
  .rules-container .w-5 {
    width: calc(1.25rem * var(--hb-font-size)) !important;
    height: calc(1.25rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .w-4,
  .dashboard-container .w-4,
  .investment-dashboard-container .w-4,
  .rules-container .w-4 {
    width: calc(1rem * var(--hb-font-size)) !important;
    height: calc(1rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .gap-4,
  .dashboard-container .gap-4,
  .investment-dashboard-container .gap-4,
  .rules-container .gap-4 {
    gap: calc(1rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .gap-3,
  .dashboard-container .gap-3,
  .investment-dashboard-container .gap-3,
  .rules-container .gap-3 {
    gap: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .gap-2,
  .dashboard-container .gap-2,
  .investment-dashboard-container .gap-2,
  .rules-container .gap-2 {
    gap: calc(0.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .pl-10,
  .dashboard-container .pl-10,
  .investment-dashboard-container .pl-10,
  .rules-container .pl-10 {
    padding-left: calc(2.5rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .pl-9,
  .dashboard-container .pl-9,
  .investment-dashboard-container .pl-9,
  .rules-container .pl-9 {
    padding-left: calc(2.25rem * var(--hb-font-size)) !important;
  }

  .account-details-scaled-container .left-3,
  .dashboard-container .left-3,
  .investment-dashboard-container .left-3,
  .rules-container .left-3 {
    left: calc(0.75rem * var(--hb-font-size)) !important;
  }

  .dashboard-container,
  .investment-dashboard-container,
  .rules-container {
    padding-bottom: calc(2rem * var(--hb-font-size)) !important;
  }

  .dashboard-container > * + *,
  .investment-dashboard-container > * + *,
  .rules-container > * + * {
    margin-top: calc(2rem * var(--hb-font-size)) !important;
  }

  .account-visibility .account-item {
    @apply cursor-pointer;
  }

  .account-visibility .account-dot {
    @apply inline-block;
  }

  /* Custom checkbox for account visibility */
  .account-visibility .account-checkbox {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 6px;
    border: 2px solid rgba(148, 163, 184, 0.4);
    display: inline-block;
    position: relative;
    cursor: pointer;
    transition: all 120ms ease;
    margin-right: 6px;
    flex: 0 0 auto;
  }

  .account-visibility .account-checkbox::after {
    content: "";
    position: absolute;
    top: 2px;
    left: 6px;
    width: 6px;
    height: 10px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg) scale(0);
    transition: transform 120ms ease-in-out;
  }

  .account-visibility .account-checkbox:checked {
    background: var(--hb-account-color, rgb(59, 130, 246));
    border-color: transparent;
    box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.08);
  }

  .account-visibility .account-checkbox:checked::after {
    transform: rotate(45deg) scale(1);
  }

  .account-visibility .account-checkbox:focus {
    outline: none;
    box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.16);
  }

  .account-visibility .toggle-all {
    @apply text-sm font-medium text-slate-600 dark:text-slate-300 underline hover:no-underline;
  }
}
